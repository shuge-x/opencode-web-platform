# 开发流程规范（自动化）

**版本**: v2.0
**更新日期**: 2026-02-13
**强制执行**: 所有人必须遵守

---

## 📋 完整开发流程

### Phase 1: 需求与设计
1. ✅ 接收需求
2. ✅ 编写PRD
3. ✅ 架构评审
4. ✅ 技术方案确认

### Phase 2: 开发
1. ✅ 本地开发
2. ✅ Git commit（提交到本地）
3. ✅ 本地测试通过

### Phase 3: 自动化流程（**必须自动执行**）
1. ✅ **Git push到GitHub**（自动）
2. ✅ **触发GitHub Actions CI/CD**（自动）
3. ✅ **运行自动化测试**（自动）
4. ✅ **构建Docker镜像**（自动）
5. ✅ **代码质量检查**（自动）
6. ✅ **自动部署**（可选，生产环境）

### Phase 4: 验收
1. ✅ 所有测试通过
2. ✅ 通知术哥验收
3. ✅ 部署到生产环境

---

## 🚨 强制规则

### 规则1：代码完成后立即push
**触发条件**：功能开发完成 + 本地测试通过
**执行动作**：
```bash
git add .
git commit -m "功能描述"
git push origin master
```

### 规则2：CI/CD必须通过
**触发条件**：Git push到GitHub
**执行动作**：
- 自动运行测试
- 自动构建Docker镜像
- 自动代码质量检查

### 规则3：测试失败必须立即修复
**触发条件**：CI/CD测试失败
**执行动作**：
- 立即修复问题
- 重新push
- 直到所有测试通过

---

## 🔧 自动化工具

### 1. GitHub Actions（CI/CD）
- **配置文件**: `.github/workflows/ci.yml`
- **触发**: push到master/main分支
- **执行内容**:
  - 后端测试（pytest + coverage）
  - 前端测试（npm test）
  - Docker构建测试
  - 代码质量检查

### 2. 代码质量检查
- **后端**: pytest-cov（测试覆盖率）
- **前端**: ESLint + TypeScript编译检查
- **Docker**: 构建测试

### 3. 自动部署（可选）
- **触发**: master分支测试通过
- **目标**: 生产环境（需配置secrets）

---

## 📊 流程图

```
需求 → PRD → 架构评审 → 开发 → 本地测试
                                      ↓
                                   Git Commit
                                      ↓
                                   Git Push（自动）
                                      ↓
                               GitHub Actions（自动）
                                      ↓
                          ┌──────────┴──────────┐
                          │                     │
                      后端测试              前端测试
                          │                     │
                          └──────────┬──────────┘
                                      ↓
                                  测试通过？
                                      ↓
                                  Yes │ No
                                      ↓  ↓
                            通知术哥验收  立即修复
                                      ↓
                                  部署生产
```

---

## ✅ 检查清单

每次开发完成后必须执行：

- [ ] 代码已commit到本地
- [ ] **已push到GitHub**（自动）
- [ ] **GitHub Actions已触发**（自动）
- [ ] **所有测试通过**（自动）
- [ ] **Docker镜像构建成功**（自动）
- [ ] **通知术哥验收**

---

## 🎯 目标

**零人工干预**：代码完成后，所有流程自动执行，直到通知术哥验收。

---

## 📝 改进记录

### v1.0（错误版本）
- ❌ 没有自动push
- ❌ 没有CI/CD配置
- ❌ 没有自动化测试

### v2.0（当前版本）
- ✅ 自动push到GitHub
- ✅ GitHub Actions CI/CD配置
- ✅ 自动化测试（后端+前端）
- ✅ Docker构建测试
- ✅ 代码质量检查

---

**负责人**: 术维斯1号
**监督**: 术哥
**强制执行**: 2026-02-13起
